<div class="board-container">
  <div class="board-grid">
    @for (row of [0,1,2,3,4,5,6,7]; track $index; let rowIndex = $index) {
    @for (col of [0,1,2,3,4,5,6,7]; track $index; let colIndex = $index) {
    <div class="square" [ngClass]="{
               'light': isLightSquare(rowIndex, colIndex),
               'dark': !isLightSquare(rowIndex, colIndex),
               'highlighted': isHighlighted(rowIndex, colIndex) && !isCaptureMove(rowIndex, colIndex),
               'can-capture': isCaptureMove(rowIndex, colIndex),
               'selected': selectedSquare === getSquareName(rowIndex, colIndex)
             }" (click)="onSquareClick(rowIndex, colIndex)">

      <!-- Coordinates -->
      @if (colIndex === 0) {
      <span class="coordinate rank">{{ 8 - rowIndex }}</span>
      }
      @if (rowIndex === 7) {
      <span class="coordinate file">{{ ['a','b','c','d','e','f','g','h'][colIndex] }}</span>
      }

      <!-- Piece -->
      @if ((board$ | async)?.[rowIndex]?.[colIndex]; as piece) {
      <app-piece [type]="piece.type" [color]="piece.color">
      </app-piece>
      }
    </div>
    }
    }
  </div>
</div>